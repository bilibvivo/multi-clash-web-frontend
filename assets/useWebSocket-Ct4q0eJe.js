import{r as d}from"./react-vendor-BxsFYPlk.js";function y(c){const[l,n]=d.useState(null),[i,r]=d.useState(!1),f=d.useRef(null);return d.useEffect(()=>{if(!c){r(!1);return}const s=new WebSocket(c);return f.current=s,s.onopen=()=>{r(!0),console.log("WebSocket connected:",c)},s.onmessage=e=>{r(!0);try{let t=e.data;if(typeof e.data=="string")try{t=JSON.parse(e.data)}catch{t=e.data}else if(e.data instanceof Blob){e.data.text().then(o=>{try{const a=JSON.parse(o);n(a)}catch{n(o)}}).catch(o=>{});return}else if(e.data instanceof ArrayBuffer){const a=new TextDecoder().decode(e.data);try{t=JSON.parse(a)}catch{t=a}}t&&typeof t=="object"&&"connections"in t&&t.connections===null&&(t.connections=[]),n(t)}catch{try{n(e.data)}catch{}}},s.onerror=e=>{console.error("WebSocket error:",e),r(!1)},s.onclose=()=>{r(!1),console.log("WebSocket closed:",c)},()=>{(s.readyState===WebSocket.OPEN||s.readyState===WebSocket.CONNECTING)&&s.close()}},[c]),{lastMessage:l,isConnected:i,sendMessage:s=>{f.current&&i&&f.current.send(JSON.stringify(s))}}}export{y as u};
